{% extends "classifieds/base.html" %}
{% load i18n %}

{% block content %}
<div class="container py-5">
    <h1 class="text-center mb-5">{% trans "Choose Your Plan" %}</h1>

    <div class="row justify-content-center">
        {% for plan in plans %}
        <div class="col-md-4 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="card-header bg-primary text-white text-center py-3">
                    <h3 class="my-0 fw-normal">{{ plan.name }}</h3>
                </div>
                <div class="card-body d-flex flex-column">
                    <h2 class="card-title pricing-card-title text-center">
                        ${{ plan.price }} <small class="text-muted">/ {{ plan.get_duration_display }}</small>
                    </h2>
                    <p class="mt-3 mb-4 text-center">{{ plan.description }}</p>
                    <div class="mt-auto">
                        {% if payment_methods.count > 1 %}
                            <form action="{% url 'subscriptions:create_checkout_session' plan.id %}" method="get">
                                <div class="mb-3">
                                    <label class="form-label">{% trans "Select Payment Method" %}</label>
                                    <select name="provider" class="form-select mb-2">
                                        {% for method in payment_methods %}
                                        <option value="{{ method.provider_id }}">{{ method.name }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-lg btn-block btn-outline-primary w-100">
                                    {% trans "Subscribe" %}
                                </button>
                            </form>
                        {% else %}
                            <a href="{% url 'subscriptions:create_checkout_session' plan.id %}" class="btn btn-lg btn-block btn-outline-primary w-100">
                                {% trans "Subscribe" %}
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12 text-center">
            <p>{% trans "No plans available at the moment." %}</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
